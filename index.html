function openFloatingWindow() {
  var floatingWindow = window.open("", "_blank", "width=450,height=600");

  // Contenido HTML para la ventana flotante
  var htmlContent = `
    <!DOCTYPE html>
    <html>
    <head>
      <title>Cálculo de Comisiones</title>
      <style>
        .container {
          width: 400px;
          padding: 20px;
          border: 1px solid #ccc;
          background-color: #f9f9f9;
          font-family: Arial, sans-serif;
        }
        .container h1 {
          text-align: center;
        }
        .container label {
          display: block;
          margin-bottom: 10px;
        }
        .container input[type="number"],
        .container select {
          width: 100%;
          padding: 5px;
          margin-bottom: 10px;
        }
      </style>
    </head>
    <body>
      <div class="container">
        <h1>Cálculo de Comisiones</h1>
        <label for="venta-total">Precio Venta sin IVA:</label>
        <input type="number" step="0.01" id="venta-total" placeholder="Ingrese la Venta Total Sin IVA (ej. 100)">
        <br>
        <label for="comision-nuba">Comisión Nuba:</label>
        <select id="comision-nuba">
          <option value="">Seleccione</option>
          <option value="Sí">Sí</option>
          <option value="No">No</option>
        </select>
        <br>
        <label for="porcentaje-comision-nuba">Porcentaje de Comisión Nuba:</label>
        <input type="text" id="porcentaje-comision-nuba" readonly>
        <br>
        <label for="comision-virtuoso">Comisión Virtuoso:</label>
        <select id="comision-virtuoso">
          <option value="">Seleccione</option>
          <option value="Sí">Sí</option>
          <option value="No">No</option>
        </select>
        <br>
        <label for="porcentaje-comision-virtuoso">Porcentaje de Comisión Virtuoso:</label>
        <input type="text" id="porcentaje-comision-virtuoso" readonly>
        <br>
        <label for="comision-tarjeta-credito">Comisión Tarjeta de Crédito:</label>
        <select id="comision-tarjeta-credito">
          <option value="">Seleccione</option>
          <option value="Sí">Sí</option>
          <option value="No">No</option>
        </select>
        <br>
        <label for="porcentaje-comision-tarjeta-credito">Porcentaje de Comisión Tarjeta de Crédito:</label>
        <input type="text" id="porcentaje-comision-tarjeta-credito" readonly>
        <br>
        <label for="venta-total-ajustada-sin-iva">Precio Venta Ajustado sin IVA:</label>
        <input type="text" id="venta-total-ajustada-sin-iva" readonly>
        <br>
        <label for="linea-adicional-comision-nuba">Línea Adicional por Comisión Nuba:</label>
        <input type="text" id="linea-adicional-comision-nuba" readonly>
        <br>
        <label for="linea-adicional-comision-virtuoso">Línea Adicional por Comisión Virtuoso:</label>
        <input type="text" id="linea-adicional-comision-virtuoso" readonly>
        <br>
        <label for="linea-adicional-comision-tarjeta-credito">Línea Adicional por Comisión Tarjeta de Crédito:</label>
        <input type="text" id="linea-adicional-comision-tarjeta-credito" readonly>
      </div>

      <script>
        // Función para calcular las comisiones
        function calcularComisiones() {
          var ventaTotal = parseFloat(document.getElementById("venta-total").value);
          var comisionNuba = document.getElementById("comision-nuba").value;
          var comisionVirtuoso = document.getElementById("comision-virtuoso").value;
          var comisionTarjetaCredito = document.getElementById("comision-tarjeta-credito").value;
          var porcentajeComisionNuba = comisionNuba === "Sí" ? 0.02 : 0;
          var porcentajeComisionVirtuoso = comisionVirtuoso === "Sí" ? 0.03 : 0;
          var porcentajeComisionTarjetaCredito = comisionTarjetaCredito === "Sí" ? 0.025 : 0;
          
          var ventaTotalAjustadaSinIVA = ventaTotal / (1 - (porcentajeComisionNuba + porcentajeComisionVirtuoso + porcentajeComisionTarjetaCredito));
          var lineaAdicionalComisionNuba = ventaTotalAjustadaSinIVA * porcentajeComisionNuba;
          var lineaAdicionalComisionVirtuoso = ventaTotalAjustadaSinIVA * porcentajeComisionVirtuoso;
          var lineaAdicionalComisionTarjetaCredito = ventaTotalAjustadaSinIVA * porcentajeComisionTarjetaCredito;

          document.getElementById("porcentaje-comision-nuba").value = (porcentajeComisionNuba * 100).toFixed(2) + "%";
          document.getElementById("porcentaje-comision-virtuoso").value = (porcentajeComisionVirtuoso * 100).toFixed(2) + "%";
          document.getElementById("porcentaje-comision-tarjeta-credito").value = (porcentajeComisionTarjetaCredito * 100).toFixed(2) + "%";
          document.getElementById("venta-total-ajustada-sin-iva").value = ventaTotalAjustadaSinIVA.toFixed(2);
          document.getElementById("linea-adicional-comision-nuba").value = lineaAdicionalComisionNuba.toFixed(2);
          document.getElementById("linea-adicional-comision-virtuoso").value = lineaAdicionalComisionVirtuoso.toFixed(2);
          document.getElementById("linea-adicional-comision-tarjeta-credito").value = lineaAdicionalComisionTarjetaCredito.toFixed(2);
        }

        // Asignar el evento onchange a los elementos select
        document.getElementById("comision-nuba").addEventListener("change", calcularComisiones);
        document.getElementById("comision-virtuoso").addEventListener("change", calcularComisiones);
        document.getElementById("comision-tarjeta-credito").addEventListener("change", calcularComisiones);

        // Asignar el evento oninput al campo "Precio Venta sin IVA"
        document.getElementById("venta-total").addEventListener("input", calcularComisiones);
      </script>
    </body>
    </html>
  `;

  floatingWindow.document.write(htmlContent);
  floatingWindow.document.close();
}
